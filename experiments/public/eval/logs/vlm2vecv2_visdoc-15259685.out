=== Running visdoc ===
/projects/bfln/abasu2/conda_envs/vlm2vec/lib/python3.10/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/projects/bfln/abasu2/conda_envs/vlm2vec/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
DropoutAddRMSNorm of flash_attn is not installed!!!
/u/abasu2/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
[2026-01-02 18:08:27,036] INFO [src.utils.basic_utils:21] Distributed init debug info:
[2026-01-02 18:08:27,036] INFO [src.utils.basic_utils:21] RANK: None
[2026-01-02 18:08:27,036] INFO [src.utils.basic_utils:21] LOCAL_RANK: None
[2026-01-02 18:08:27,036] INFO [src.utils.basic_utils:21] WORLD_SIZE: None
[2026-01-02 18:08:27,036] INFO [src.utils.basic_utils:21] MASTER_ADDR: None
[2026-01-02 18:08:27,036] INFO [src.utils.basic_utils:21] MASTER_PORT: None
[2026-01-02 18:08:28,043] INFO [src.utils.basic_utils:21] Model Backbone: qwen2_vl
[2026-01-02 18:08:28,044] INFO [src.utils.basic_utils:21] Loading processor from: VLM2Vec/VLM2Vec-V2.0
[2026-01-02 18:08:29,874] INFO [src.utils.basic_utils:21] Loading backbone [qwen2_vl] from VLM2Vec/VLM2Vec-V2.0
Fetching 2 files:   0%|          | 0/2 [00:00<?, ?it/s]Fetching 2 files: 100%|██████████| 2/2 [00:00<00:00, 13086.75it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  1.39it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  2.67it/s]
[2026-01-02 18:08:44,084] INFO [src.utils.basic_utils:21] [rank=0] Loading the model from Huggingface: VLM2Vec/VLM2Vec-V2.0...
[2026-01-02 18:08:47,377] INFO [src.utils.basic_utils:21] --- Evaluating ViDoRe_arxivqa ---
Generating test split:   0%|          | 0/500 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 500/500 [00:00<00:00, 604.49 examples/s]Generating test split: 100%|██████████| 500/500 [00:00<00:00, 587.80 examples/s]
Generating test split:   0%|          | 0/500 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 500/500 [00:00<00:00, 84118.25 examples/s]
Generating test split:   0%|          | 0/500 [00:00<?, ? examples/s]Generating test split:  40%|████      | 200/500 [00:00<00:00, 1014.06 examples/s]Generating test split: 100%|██████████| 500/500 [00:00<00:00, 1869.68 examples/s]
[2026-01-02 18:08:55,502] INFO [src.utils.basic_utils:21] Loaded ViDoRe_arxivqa
[2026-01-02 18:08:55,502] INFO [src.utils.basic_utils:21] #hf_dataset_name=vidore/arxivqa_test_subsampled_beir
[2026-01-02 18:08:55,502] INFO [src.utils.basic_utils:21] #hf_dataset_split=test
[2026-01-02 18:08:55,502] INFO [src.utils.basic_utils:21] #queries=500
[2026-01-02 18:08:55,502] INFO [src.utils.basic_utils:21] #cand=500
[2026-01-02 18:08:55,503] INFO [src.utils.basic_utils:21] #qrels=500
Map (num_proc=8):   0%|          | 0/500 [00:00<?, ? examples/s]Map (num_proc=8):  12%|█▏        | 62/500 [00:11<01:18,  5.55 examples/s]Map (num_proc=8):  50%|████▉     | 249/500 [00:11<00:08, 28.57 examples/s]Map (num_proc=8):  75%|███████▍  | 374/500 [00:11<00:02, 48.56 examples/s]Map (num_proc=8): 100%|██████████| 500/500 [00:11<00:00, 76.69 examples/s]Map (num_proc=8): 100%|██████████| 500/500 [00:12<00:00, 40.30 examples/s]
Map (num_proc=8):   0%|          | 0/500 [00:00<?, ? examples/s]Map (num_proc=8):  13%|█▎        | 63/500 [00:00<00:01, 243.06 examples/s]Map (num_proc=8):  75%|███████▌  | 376/500 [00:00<00:00, 1186.11 examples/s]Map (num_proc=8): 100%|██████████| 500/500 [00:00<00:00, 761.04 examples/s] 
[2026-01-02 18:09:08,709] INFO [src.utils.basic_utils:21] Encoding queries...
Queries for ViDoRe_arxivqa (rank 0):   0%|          | 0/32 [00:00<?, ?it/s]You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
Queries for ViDoRe_arxivqa (rank 0):   3%|▎         | 1/32 [00:05<02:51,  5.55s/it]Queries for ViDoRe_arxivqa (rank 0):   6%|▋         | 2/32 [00:05<01:10,  2.35s/it]Queries for ViDoRe_arxivqa (rank 0):   9%|▉         | 3/32 [00:05<00:38,  1.32s/it]Queries for ViDoRe_arxivqa (rank 0):  12%|█▎        | 4/32 [00:05<00:23,  1.19it/s]Queries for ViDoRe_arxivqa (rank 0):  16%|█▌        | 5/32 [00:05<00:15,  1.74it/s]Queries for ViDoRe_arxivqa (rank 0):  19%|█▉        | 6/32 [00:06<00:10,  2.42it/s]Queries for ViDoRe_arxivqa (rank 0):  22%|██▏       | 7/32 [00:06<00:07,  3.22it/s]Queries for ViDoRe_arxivqa (rank 0):  25%|██▌       | 8/32 [00:06<00:05,  4.10it/s]Queries for ViDoRe_arxivqa (rank 0):  31%|███▏      | 10/32 [00:06<00:03,  5.71it/s]Queries for ViDoRe_arxivqa (rank 0):  38%|███▊      | 12/32 [00:06<00:02,  6.92it/s]Queries for ViDoRe_arxivqa (rank 0):  44%|████▍     | 14/32 [00:06<00:02,  7.80it/s]Queries for ViDoRe_arxivqa (rank 0):  47%|████▋     | 15/32 [00:06<00:02,  8.17it/s]Queries for ViDoRe_arxivqa (rank 0):  50%|█████     | 16/32 [00:07<00:01,  8.51it/s]Queries for ViDoRe_arxivqa (rank 0):  53%|█████▎    | 17/32 [00:07<00:01,  8.83it/s]Queries for ViDoRe_arxivqa (rank 0):  56%|█████▋    | 18/32 [00:07<00:01,  9.10it/s]Queries for ViDoRe_arxivqa (rank 0):  59%|█████▉    | 19/32 [00:07<00:01,  9.30it/s]Queries for ViDoRe_arxivqa (rank 0):  66%|██████▌   | 21/32 [00:07<00:01,  9.58it/s]Queries for ViDoRe_arxivqa (rank 0):  72%|███████▏  | 23/32 [00:07<00:00,  9.73it/s]Queries for ViDoRe_arxivqa (rank 0):  75%|███████▌  | 24/32 [00:07<00:00,  9.77it/s]Queries for ViDoRe_arxivqa (rank 0):  81%|████████▏ | 26/32 [00:08<00:00,  9.86it/s]Queries for ViDoRe_arxivqa (rank 0):  84%|████████▍ | 27/32 [00:08<00:00,  9.88it/s]Queries for ViDoRe_arxivqa (rank 0):  88%|████████▊ | 28/32 [00:08<00:00,  9.70it/s]Queries for ViDoRe_arxivqa (rank 0):  91%|█████████ | 29/32 [00:08<00:00,  9.76it/s]Queries for ViDoRe_arxivqa (rank 0):  97%|█████████▋| 31/32 [00:08<00:00,  9.87it/s]Queries for ViDoRe_arxivqa (rank 0): 100%|██████████| 32/32 [00:08<00:00,  8.76it/s]Queries for ViDoRe_arxivqa (rank 0): 100%|██████████| 32/32 [00:08<00:00,  3.67it/s]
[2026-01-02 18:09:17,458] INFO [src.utils.basic_utils:21] Saved query embeddings to /work/nvme/bfln/abasu2/vlm2vec_outputs/VLM2Vec-V2.0/visdoc/ViDoRe_arxivqa_qry
[2026-01-02 18:09:17,458] INFO [src.utils.basic_utils:21] Encoding candidates...
Candidates for ViDoRe_arxivqa (rank 0):   0%|          | 0/32 [00:00<?, ?it/s]Candidates for ViDoRe_arxivqa (rank 0):   3%|▎         | 1/32 [00:08<04:16,  8.27s/it]Candidates for ViDoRe_arxivqa (rank 0):   6%|▋         | 2/32 [00:15<03:49,  7.65s/it]Candidates for ViDoRe_arxivqa (rank 0):   9%|▉         | 3/32 [00:23<03:42,  7.67s/it]Candidates for ViDoRe_arxivqa (rank 0):  12%|█▎        | 4/32 [00:30<03:34,  7.67s/it]Candidates for ViDoRe_arxivqa (rank 0):  16%|█▌        | 5/32 [00:38<03:25,  7.60s/it]Candidates for ViDoRe_arxivqa (rank 0):  19%|█▉        | 6/32 [00:46<03:20,  7.71s/it]Candidates for ViDoRe_arxivqa (rank 0):  22%|██▏       | 7/32 [00:54<03:14,  7.78s/it]Candidates for ViDoRe_arxivqa (rank 0):  25%|██▌       | 8/32 [01:01<03:03,  7.66s/it]Candidates for ViDoRe_arxivqa (rank 0):  28%|██▊       | 9/32 [01:09<02:57,  7.70s/it]Candidates for ViDoRe_arxivqa (rank 0):  31%|███▏      | 10/32 [01:17<02:50,  7.73s/it]Candidates for ViDoRe_arxivqa (rank 0):  34%|███▍      | 11/32 [01:24<02:40,  7.62s/it]Candidates for ViDoRe_arxivqa (rank 0):  38%|███▊      | 12/32 [01:31<02:30,  7.55s/it]Candidates for ViDoRe_arxivqa (rank 0):  41%|████      | 13/32 [01:39<02:21,  7.45s/it]Candidates for ViDoRe_arxivqa (rank 0):  44%|████▍     | 14/32 [01:46<02:15,  7.54s/it]Candidates for ViDoRe_arxivqa (rank 0):  47%|████▋     | 15/32 [01:54<02:09,  7.63s/it]Candidates for ViDoRe_arxivqa (rank 0):  50%|█████     | 16/32 [02:02<02:04,  7.75s/it]Candidates for ViDoRe_arxivqa (rank 0):  53%|█████▎    | 17/32 [02:10<01:55,  7.67s/it]Candidates for ViDoRe_arxivqa (rank 0):  56%|█████▋    | 18/32 [02:18<01:47,  7.71s/it]Candidates for ViDoRe_arxivqa (rank 0):  59%|█████▉    | 19/32 [02:25<01:40,  7.72s/it]Candidates for ViDoRe_arxivqa (rank 0):  62%|██████▎   | 20/32 [02:33<01:32,  7.67s/it]Candidates for ViDoRe_arxivqa (rank 0):  66%|██████▌   | 21/32 [02:40<01:22,  7.50s/it]Candidates for ViDoRe_arxivqa (rank 0):  69%|██████▉   | 22/32 [02:48<01:15,  7.59s/it]Candidates for ViDoRe_arxivqa (rank 0):  72%|███████▏  | 23/32 [02:55<01:07,  7.49s/it]Candidates for ViDoRe_arxivqa (rank 0):  75%|███████▌  | 24/32 [03:03<01:00,  7.53s/it]Candidates for ViDoRe_arxivqa (rank 0):  78%|███████▊  | 25/32 [03:09<00:50,  7.27s/it]Candidates for ViDoRe_arxivqa (rank 0):  81%|████████▏ | 26/32 [03:17<00:44,  7.35s/it]Candidates for ViDoRe_arxivqa (rank 0):  84%|████████▍ | 27/32 [03:24<00:36,  7.36s/it]Candidates for ViDoRe_arxivqa (rank 0):  88%|████████▊ | 28/32 [03:32<00:29,  7.44s/it]Candidates for ViDoRe_arxivqa (rank 0):  91%|█████████ | 29/32 [03:39<00:22,  7.49s/it]Candidates for ViDoRe_arxivqa (rank 0):  94%|█████████▍| 30/32 [03:47<00:15,  7.57s/it]Candidates for ViDoRe_arxivqa (rank 0):  97%|█████████▋| 31/32 [03:55<00:07,  7.55s/it]Candidates for ViDoRe_arxivqa (rank 0): 100%|██████████| 32/32 [03:57<00:00,  5.84s/it]Candidates for ViDoRe_arxivqa (rank 0): 100%|██████████| 32/32 [03:57<00:00,  7.41s/it]
[2026-01-02 18:13:14,526] INFO [src.utils.basic_utils:21] Saved candidate embeddings to /work/nvme/bfln/abasu2/vlm2vec_outputs/VLM2Vec-V2.0/visdoc/ViDoRe_arxivqa_tgt
Calculating scores for ViDoRe_arxivqa: 0it [00:00, ?it/s]Calculating scores for ViDoRe_arxivqa: 500it [00:00, 28085.98it/s]
[2026-01-02 18:13:14,815] INFO [src.utils.basic_utils:21] Score of ViDoRe_arxivqa:
[2026-01-02 18:13:14,815] INFO [src.utils.basic_utils:21] {'hit@1': '0.7340', 'hit@5': '0.8640', 'hit@10': '0.9040', 'ndcg_linear@1': '0.7340', 'ndcg_linear@5': '0.8053', 'ndcg_linear@10': '0.8185', 'ndcg_exponential@1': '0.7340', 'ndcg_exponential@5': '0.8053', 'ndcg_exponential@10': '0.8185', 'precision@1': '0.7340', 'precision@5': '0.1728', 'precision@10': '0.0904', 'recall@1': '0.7340', 'recall@5': '0.8640', 'recall@10': '0.9040', 'f1@1': '0.7340', 'f1@5': '0.2880', 'f1@10': '0.1644', 'map@1': '0.7340', 'map@5': '0.7856', 'map@10': '0.7912', 'mrr@1': '0.7340', 'mrr@5': '0.7856', 'mrr@10': '0.7912'}
[2026-01-02 18:13:14,815] INFO [src.utils.basic_utils:21] Outputting final score to: /work/nvme/bfln/abasu2/vlm2vec_outputs/VLM2Vec-V2.0/visdoc/ViDoRe_arxivqa_score.json
[2026-01-02 18:13:14,836] INFO [src.utils.basic_utils:21] --- Evaluating ViDoRe_docvqa ---
Generating test split:   0%|          | 0/451 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 451/451 [00:00<00:00, 92261.19 examples/s]
Generating test split:   0%|          | 0/500 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 500/500 [00:00<00:00, 117771.21 examples/s]
Generating test split:   0%|          | 0/500 [00:00<?, ? examples/s]Generating test split:  20%|██        | 100/500 [00:00<00:00, 436.56 examples/s]Generating test split:  40%|████      | 200/500 [00:00<00:00, 614.75 examples/s]Generating test split:  80%|████████  | 400/500 [00:00<00:00, 1033.53 examples/s]Generating test split: 100%|██████████| 500/500 [00:00<00:00, 942.11 examples/s] 
[2026-01-02 18:13:21,336] INFO [src.utils.basic_utils:21] Loaded ViDoRe_docvqa
[2026-01-02 18:13:21,337] INFO [src.utils.basic_utils:21] #hf_dataset_name=vidore/docvqa_test_subsampled_beir
[2026-01-02 18:13:21,337] INFO [src.utils.basic_utils:21] #hf_dataset_split=test
[2026-01-02 18:13:21,337] INFO [src.utils.basic_utils:21] #queries=451
[2026-01-02 18:13:21,337] INFO [src.utils.basic_utils:21] #cand=500
[2026-01-02 18:13:21,337] INFO [src.utils.basic_utils:21] #qrels=500
Map (num_proc=8):   0%|          | 0/500 [00:00<?, ? examples/s]Map (num_proc=8):  13%|█▎        | 63/500 [03:06<21:34,  2.96s/ examples]Map (num_proc=8):  25%|██▌       | 126/500 [03:24<08:40,  1.39s/ examples]Map (num_proc=8):  38%|███▊      | 188/500 [03:55<05:08,  1.01 examples/s]Map (num_proc=8):  50%|█████     | 251/500 [04:00<02:35,  1.60 examples/s]Map (num_proc=8):  63%|██████▎   | 313/500 [04:08<01:23,  2.23 examples/s]Map (num_proc=8):  75%|███████▌  | 375/500 [04:09<00:37,  3.33 examples/s]Map (num_proc=8):  88%|████████▊ | 438/500 [04:11<00:13,  4.76 examples/s]Map (num_proc=8): 100%|██████████| 500/500 [04:12<00:00,  6.67 examples/s]Map (num_proc=8): 100%|██████████| 500/500 [04:12<00:00,  1.98 examples/s]
Map (num_proc=8):   0%|          | 0/451 [00:00<?, ? examples/s]Map (num_proc=8):  12%|█▏        | 56/451 [00:00<00:03, 108.35 examples/s]Map (num_proc=8): 100%|██████████| 451/451 [00:00<00:00, 494.32 examples/s]
[2026-01-02 18:17:35,462] INFO [src.utils.basic_utils:21] Encoding queries...
Queries for ViDoRe_docvqa (rank 0):   0%|          | 0/29 [00:00<?, ?it/s]Queries for ViDoRe_docvqa (rank 0):   3%|▎         | 1/29 [00:00<00:21,  1.29it/s]Queries for ViDoRe_docvqa (rank 0):  10%|█         | 3/29 [00:00<00:07,  3.60it/s]Queries for ViDoRe_docvqa (rank 0):  17%|█▋        | 5/29 [00:01<00:04,  5.39it/s]Queries for ViDoRe_docvqa (rank 0):  24%|██▍       | 7/29 [00:01<00:03,  6.72it/s]Queries for ViDoRe_docvqa (rank 0):  31%|███       | 9/29 [00:01<00:02,  7.69it/s]Queries for ViDoRe_docvqa (rank 0):  38%|███▊      | 11/29 [00:01<00:02,  8.41it/s]Queries for ViDoRe_docvqa (rank 0):  45%|████▍     | 13/29 [00:01<00:01,  8.92it/s]Queries for ViDoRe_docvqa (rank 0):  52%|█████▏    | 15/29 [00:02<00:01,  9.27it/s]Queries for ViDoRe_docvqa (rank 0):  59%|█████▊    | 17/29 [00:02<00:01,  9.52it/s]Queries for ViDoRe_docvqa (rank 0):  66%|██████▌   | 19/29 [00:02<00:01,  9.67it/s]Queries for ViDoRe_docvqa (rank 0):  69%|██████▉   | 20/29 [00:02<00:00,  9.73it/s]Queries for ViDoRe_docvqa (rank 0):  72%|███████▏  | 21/29 [00:02<00:00,  9.78it/s]Queries for ViDoRe_docvqa (rank 0):  79%|███████▉  | 23/29 [00:02<00:00,  9.91it/s]Queries for ViDoRe_docvqa (rank 0):  86%|████████▌ | 25/29 [00:03<00:00, 10.01it/s]Queries for ViDoRe_docvqa (rank 0):  93%|█████████▎| 27/29 [00:03<00:00, 10.04it/s]Queries for ViDoRe_docvqa (rank 0): 100%|██████████| 29/29 [00:03<00:00, 10.11it/s]Queries for ViDoRe_docvqa (rank 0): 100%|██████████| 29/29 [00:03<00:00,  8.17it/s]
[2026-01-02 18:17:39,139] INFO [src.utils.basic_utils:21] Saved query embeddings to /work/nvme/bfln/abasu2/vlm2vec_outputs/VLM2Vec-V2.0/visdoc/ViDoRe_docvqa_qry
[2026-01-02 18:17:39,139] INFO [src.utils.basic_utils:21] Encoding candidates...
Candidates for ViDoRe_docvqa (rank 0):   0%|          | 0/32 [00:00<?, ?it/s]Candidates for ViDoRe_docvqa (rank 0):   3%|▎         | 1/32 [00:08<04:11,  8.11s/it]Candidates for ViDoRe_docvqa (rank 0):   6%|▋         | 2/32 [00:16<04:03,  8.11s/it]Candidates for ViDoRe_docvqa (rank 0):   9%|▉         | 3/32 [00:24<04:03,  8.40s/it]Candidates for ViDoRe_docvqa (rank 0):  12%|█▎        | 4/32 [00:32<03:46,  8.08s/it]Candidates for ViDoRe_docvqa (rank 0):  16%|█▌        | 5/32 [00:40<03:39,  8.12s/it]Candidates for ViDoRe_docvqa (rank 0):  19%|█▉        | 6/32 [00:48<03:28,  8.04s/it]Candidates for ViDoRe_docvqa (rank 0):  22%|██▏       | 7/32 [00:56<03:16,  7.85s/it]Candidates for ViDoRe_docvqa (rank 0):  25%|██▌       | 8/32 [01:03<03:06,  7.77s/it]Candidates for ViDoRe_docvqa (rank 0):  28%|██▊       | 9/32 [01:11<03:01,  7.89s/it]Candidates for ViDoRe_docvqa (rank 0):  31%|███▏      | 10/32 [01:18<02:47,  7.63s/it]Candidates for ViDoRe_docvqa (rank 0):  34%|███▍      | 11/32 [01:26<02:41,  7.67s/it]Candidates for ViDoRe_docvqa (rank 0):  38%|███▊      | 12/32 [01:35<02:38,  7.94s/it]Candidates for ViDoRe_docvqa (rank 0):  41%|████      | 13/32 [01:43<02:31,  8.00s/it]Candidates for ViDoRe_docvqa (rank 0):  44%|████▍     | 14/32 [01:50<02:21,  7.85s/it]Candidates for ViDoRe_docvqa (rank 0):  47%|████▋     | 15/32 [01:58<02:11,  7.73s/it]Candidates for ViDoRe_docvqa (rank 0):  50%|█████     | 16/32 [02:05<02:02,  7.68s/it]Candidates for ViDoRe_docvqa (rank 0):  53%|█████▎    | 17/32 [02:13<01:56,  7.77s/it]Candidates for ViDoRe_docvqa (rank 0):  56%|█████▋    | 18/32 [02:21<01:48,  7.72s/it]Candidates for ViDoRe_docvqa (rank 0):  59%|█████▉    | 19/32 [02:29<01:40,  7.74s/it]Candidates for ViDoRe_docvqa (rank 0):  62%|██████▎   | 20/32 [02:36<01:31,  7.66s/it]Candidates for ViDoRe_docvqa (rank 0):  66%|██████▌   | 21/32 [02:44<01:24,  7.68s/it]Candidates for ViDoRe_docvqa (rank 0):  69%|██████▉   | 22/32 [02:52<01:16,  7.67s/it]Candidates for ViDoRe_docvqa (rank 0):  72%|███████▏  | 23/32 [03:00<01:10,  7.80s/it]Candidates for ViDoRe_docvqa (rank 0):  75%|███████▌  | 24/32 [03:07<01:01,  7.73s/it]Candidates for ViDoRe_docvqa (rank 0):  78%|███████▊  | 25/32 [03:16<00:56,  8.06s/it]Candidates for ViDoRe_docvqa (rank 0):  81%|████████▏ | 26/32 [03:24<00:47,  7.89s/it]Candidates for ViDoRe_docvqa (rank 0):  84%|████████▍ | 27/32 [03:32<00:39,  7.90s/it]Candidates for ViDoRe_docvqa (rank 0):  88%|████████▊ | 28/32 [03:38<00:30,  7.62s/it]Candidates for ViDoRe_docvqa (rank 0):  91%|█████████ | 29/32 [03:46<00:22,  7.60s/it]Candidates for ViDoRe_docvqa (rank 0):  94%|█████████▍| 30/32 [03:54<00:15,  7.66s/it]Candidates for ViDoRe_docvqa (rank 0):  97%|█████████▋| 31/32 [04:01<00:07,  7.38s/it]Candidates for ViDoRe_docvqa (rank 0): 100%|██████████| 32/32 [04:02<00:00,  5.66s/it]Candidates for ViDoRe_docvqa (rank 0): 100%|██████████| 32/32 [04:02<00:00,  7.58s/it]
[2026-01-02 18:21:41,952] INFO [src.utils.basic_utils:21] Saved candidate embeddings to /work/nvme/bfln/abasu2/vlm2vec_outputs/VLM2Vec-V2.0/visdoc/ViDoRe_docvqa_tgt
Calculating scores for ViDoRe_docvqa: 0it [00:00, ?it/s]Calculating scores for ViDoRe_docvqa: 451it [00:00, 9099.76it/s]
[2026-01-02 18:21:42,326] INFO [src.utils.basic_utils:21] Score of ViDoRe_docvqa:
[2026-01-02 18:21:42,326] INFO [src.utils.basic_utils:21] {'hit@1': '0.3503', 'hit@5': '0.5388', 'hit@10': '0.6253', 'ndcg_linear@1': '0.3503', 'ndcg_linear@5': '0.4487', 'ndcg_linear@10': '0.4768', 'ndcg_exponential@1': '0.3503', 'ndcg_exponential@5': '0.4487', 'ndcg_exponential@10': '0.4768', 'precision@1': '0.3503', 'precision@5': '0.1086', 'precision@10': '0.0639', 'recall@1': '0.3452', 'recall@5': '0.5303', 'recall@10': '0.6168', 'f1@1': '0.3466', 'f1@5': '0.1792', 'f1@10': '0.1151', 'map@1': '0.3503', 'map@5': '0.4192', 'map@10': '0.4308', 'mrr@1': '0.3503', 'mrr@5': '0.4255', 'mrr@10': '0.4367'}
[2026-01-02 18:21:42,326] INFO [src.utils.basic_utils:21] Outputting final score to: /work/nvme/bfln/abasu2/vlm2vec_outputs/VLM2Vec-V2.0/visdoc/ViDoRe_docvqa_score.json
[2026-01-02 18:21:42,346] INFO [src.utils.basic_utils:21] --- Evaluating ViDoRe_infovqa ---
Generating test split:   0%|          | 0/494 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 494/494 [00:00<00:00, 1051.48 examples/s]Generating test split: 100%|██████████| 494/494 [00:00<00:00, 1047.40 examples/s]
Generating test split:   0%|          | 0/500 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 500/500 [00:00<00:00, 96243.78 examples/s]
Generating test split:   0%|          | 0/500 [00:00<?, ? examples/s]Generating test split:  20%|██        | 100/500 [00:00<00:00, 570.40 examples/s]Generating test split:  80%|████████  | 400/500 [00:00<00:00, 1354.38 examples/s]Generating test split: 100%|██████████| 500/500 [00:00<00:00, 1366.34 examples/s]
[2026-01-02 18:22:10,022] INFO [src.utils.basic_utils:21] Loaded ViDoRe_infovqa
[2026-01-02 18:22:10,022] INFO [src.utils.basic_utils:21] #hf_dataset_name=vidore/infovqa_test_subsampled_beir
[2026-01-02 18:22:10,022] INFO [src.utils.basic_utils:21] #hf_dataset_split=test
[2026-01-02 18:22:10,022] INFO [src.utils.basic_utils:21] #queries=494
[2026-01-02 18:22:10,022] INFO [src.utils.basic_utils:21] #cand=500
[2026-01-02 18:22:10,022] INFO [src.utils.basic_utils:21] #qrels=500
Map (num_proc=8):   0%|          | 0/500 [00:00<?, ? examples/s]Map (num_proc=8):  12%|█▏        | 62/500 [00:15<01:48,  4.03 examples/s]Map (num_proc=8):  25%|██▌       | 125/500 [00:15<00:38,  9.63 examples/s]Map (num_proc=8):  38%|███▊      | 188/500 [00:15<00:17, 17.45 examples/s]Map (num_proc=8):  50%|█████     | 250/500 [00:16<00:09, 26.21 examples/s]Map (num_proc=8):  75%|███████▌  | 375/500 [00:16<00:02, 49.99 examples/s]Map (num_proc=8):  88%|████████▊ | 438/500 [00:17<00:01, 52.81 examples/s]Map (num_proc=8): 100%|██████████| 500/500 [00:18<00:00, 60.30 examples/s][2026-01-02T18:22:29.136] error: *** JOB 15259685 ON gpua045 CANCELLED AT 2026-01-02T18:22:29 DUE to SIGNAL Terminated ***
